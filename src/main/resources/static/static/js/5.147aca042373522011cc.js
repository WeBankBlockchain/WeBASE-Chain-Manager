webpackJsonp([5],{"Jm2/":function(e,t){},fZX7:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o("1HuH"),r=o("P9l9"),n=o("U+Q4"),s={name:"addGroup",props:["show"],data:function(){return{dialogVisible:this.show,nodeList:[],loading:!1,groupId:null,groupFrom:{generateGroupId:"",description:"",nodeList:[],timestamp:0},rules:{generateGroupId:[{required:!0,message:"请输入群组编号",trigger:"blur"}]}}},mounted:function(){this.getFrontList()},methods:{modelClose:function(){this.$emit("close")},getFrontList:function(){var e=this,t={chainId:localStorage.getItem("chainId")};Object(r.h)(t).then(function(t){0===t.data.code&&(e.nodeList=t.data.data)})},handleSelectionChange:function(e){if(this.groupFrom.nodeList=[],e&&e.length)for(var t=0;t<e.length;t++)this.groupFrom.nodeList.push(e[t].nodeId)},submit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.newGroup()})},newGroup:function(){var e=this,t={chainId:localStorage.getItem("chainId"),generateGroupId:this.groupFrom.generateGroupId,timestamp:(new Date).getTime(),nodeList:this.groupFrom.nodeList,description:this.groupFrom.description};Object(r.c)(t).then(function(t){e.loading=!1,0===t.data.code?(e.groupId=t.data.data.groupId,e.startAllGroup(e.groupId,e.groupFrom.nodeList)):e.$message({type:"error",message:n.a.errCode[t.data.code].zh})}).catch(function(t){e.loading=!1,e.$message({type:"error",message:"系统错误"})})},startAllGroup:function(e,t){var o=this,a={chainId:localStorage.getItem("chainId"),generateGroupId:e,nodeList:t};Object(r.d)(a).then(function(e){0===e.data.code?o.update():o.$message({type:"error",message:n.a.errCode[e.data.code].zh||"启动群组失败"})}).catch(function(e){o.$message({type:"error",message:"系统错误"})})},update:function(){var e=this;Object(r.n)().then(function(t){0===t.data.code?(e.$message({type:"success",message:"群组创建成功！"}),e.loading=!1,e.modelClose()):e.$message({type:"error",message:n.a.errCode[t.data.code].zh||"群组更新失败"})}).catch(function(t){e.$message({type:"error",message:"系统错误"})})}}},i={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-dialog",{staticClass:"dialog-wrapper",attrs:{title:"新增群组",visible:e.dialogVisible,"before-close":e.modelClose,width:"65%",center:!0,"show-close":!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[o("div",[o("el-form",{ref:"groupFrom",staticClass:"demo-ruleForm",attrs:{model:e.groupFrom,rules:e.rules,"label-width":"100px"}},[o("el-form-item",{staticStyle:{width:"330px"},attrs:{label:"群组编号",prop:"generateGroupId"}},[o("el-input",{model:{value:e.groupFrom.generateGroupId,callback:function(t){e.$set(e.groupFrom,"generateGroupId",t)},expression:"groupFrom.generateGroupId"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"节点列表"}},[o("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.nodeList,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[o("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),o("el-table-column",{attrs:{label:"前置编号",prop:"frontId",width:"120"}}),e._v(" "),o("el-table-column",{attrs:{prop:"nodeId",label:"节点编号"}}),e._v(" "),o("el-table-column",{attrs:{prop:"frontIp",label:"前置IP",width:"120"}}),e._v(" "),o("el-table-column",{attrs:{prop:"frontPort",label:"前置端口",width:"120"}}),e._v(" "),o("el-table-column",{attrs:{prop:"agency",label:"所属机构",width:"180"}})],1)],1),e._v(" "),o("el-form-item",{staticStyle:{width:"330px"},attrs:{label:"备注"}},[o("el-input",{model:{value:e.groupFrom.description,callback:function(t){e.$set(e.groupFrom,"description",t)},expression:"groupFrom.description"}})],1)],1)],1),e._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:e.modelClose}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(t){return e.submit("groupFrom")}}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var l=o("VU/8")(s,i,!1,function(e){o("Jm2/")},null,null).exports,d=o("YaEn"),u={name:"front",components:{"v-content-head":a.a,"add-group":l},data:function(){return{groupData:[],loading:!1,addGroupShow:!1}},mounted:function(){localStorage.getItem("chainId")&&this.getGroupList()},methods:{changGroup:function(){this.getGroupList()},createGroup:function(){this.addGroupShow=!0},getGroupList:function(){var e=this;Object(r.i)(localStorage.getItem("chainId")).then(function(t){0===t.data.code?e.groupData=t.data.data:e.$message({type:"error",message:n.a.errCode[t.data.code].zh})}).catch(function(t){e.$message({type:"error",message:"系统错误"})})},addGroupClose:function(){this.addGroupShow=!1,localStorage.getItem("chainId")&&this.getGroupList()},route:function(e){d.a.push({path:"/node",query:{groupName:e.groupName,groupId:e.groupId}})}}},c={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("v-content-head",{attrs:{headTitle:"群组管理"},on:{changGroup:e.changGroup}}),e._v(" "),o("div",{staticClass:"module-wrapper"},[o("h3",{staticStyle:{padding:"20px 0 0 40px"}},[e._v("群组列表")]),e._v(" "),o("div",{staticClass:"search-part",staticStyle:{"padding-top":"20px"}},[o("div",{staticClass:"search-part-left"},[o("el-button",{staticClass:"search-part-left-btn",attrs:{type:"primary"},on:{click:e.createGroup}},[e._v("新增群组")])],1)]),e._v(" "),o("div",{staticClass:"search-table"},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"search-table-content",attrs:{data:e.groupData}},[o("el-table-column",{attrs:{prop:"groupId",label:"群组编号"}}),e._v(" "),o("el-table-column",{attrs:{prop:"groupName",label:"群组名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",{staticClass:"group-route",on:{click:function(o){return e.route(t.row)}}},[e._v(e._s(t.row.groupName))])]}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"nodeCount",label:"节点数量"}}),e._v(" "),o("el-table-column",{attrs:{prop:"createTime",label:"创建时间"}})],1)],1)]),e._v(" "),e.addGroupShow?o("add-group",{attrs:{show:e.addGroupShow},on:{close:e.addGroupClose}}):e._e()],1)},staticRenderFns:[]};var p=o("VU/8")(u,c,!1,function(e){o("uA61")},"data-v-8059a0e0",null);t.default=p.exports},uA61:function(e,t){}});